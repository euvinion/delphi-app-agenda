unit FAgenda;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Data.DB, Vcl.StdCtrls, Vcl.Grids,
  Vcl.DBGrids, Vcl.ExtCtrls;

type
  TFrmAgenda = class(TForm)
    Base: TPanel;
    Grid: TDBGrid;
    Memo: TMemo;
    EditPesquisar: TEdit;
    BtnClickPesquisar: TButton;
    BtnClickNovo: TButton;
    BtnClickEditar: TButton;
    BtnClickFechar: TButton;
    procedure BtnClickNovoClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure ResizeControls(ParentCtrl: TWinControl; BaseW, BaseH, NewW, NewH: Integer);
    procedure FormResize(Sender: TObject);
    procedure AtualizarGrid;
    procedure FormShow(Sender: TObject);
    procedure BtnClickPesquisarClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FrmAgenda: TFrmAgenda;


implementation

{$R *.dfm}

uses Database, FCadastroNovo, UCalcular, UValidarCampos;


procedure TFrmAgenda.AtualizarGrid;
begin
  DM.QryAgenda.Close;
  DM.QryAgenda.SQL.Text := 'SELECT * FROM novos';
  DM.QryAgenda.Open;
end;

procedure TFrmAgenda.BtnClickNovoClick(Sender: TObject);
begin
  FrmNovo.Show;
end;

procedure TFrmAgenda.BtnClickPesquisarClick(Sender: TObject);
begin
  DM.QryAgenda.Close;
  DM.QryAgenda.SQL.Clear;

  if Trim(EditPesquisar.Text) = '' then
  begin
    DM.QryAgenda.SQL.Add('SELECT * FROM novos');
  end
  else
  begin
    DM.QryAgenda.SQL.Add('SELECT * FROM novos WHERE nome LIKE :nome');
    DM.QryAgenda.ParamByName('nome').AsString := '%' + EditPesquisar.Text + '%';
  end;

  DM.QryAgenda.Open;
end;

procedure TFrmAgenda.FormResize(Sender: TObject);
begin
  UCalcular.ResizeControls(Base, FBaseW, FBaseH, Base.Width, Base.Height);
end;

end.
